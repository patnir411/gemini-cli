# Caddyfile - Reverse proxy with automatic TLS
#
# Replace YOUR_DOMAIN with your actual domain name.
# Caddy will automatically obtain and renew Let's Encrypt certificates.
#
# For development/testing without a domain, use:
#   :443 {
#     tls internal
#     ...
#   }

{$DOMAIN:localhost} {
    # For local development, use self-signed certs
    tls {$TLS_MODE:internal}

    # Reverse proxy to the API server
    reverse_proxy api:8443 {
        # Disable response buffering for SSE streaming
        flush_interval -1
    }

    # Request logging
    log {
        output stdout
        format console
    }

    # Security headers
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "DENY"
    }
}
